
CREATE FUNCTION dbo.RandomMiddlename
(
  @gender int
)
RETURNS nvarchar(max)
as
begin

declare  @names_m TABLE (
  id         int           NOT NULL identity(1,1),
  middlename nvarchar(255) DEFAULT NULL,
  gender     int           DEFAULT NULL check(gender in (1,2))
) 

INSERT INTO @names_m (middlename, gender)
VALUES
	('Александрович',1),
	('Алексеевич',1),
	('Альбертович',1),
	('Анатольевич',1),
	('Андреевич',1),
	('Антонович',1),
	('Арсланович',1),
	('Афанасьевич',1),
	('Богданович',1),
	('Борисович',1),
	('Вадимович',1),
	('Валентинович',1),
	('Валерьевич',1),
	('Васильевич',1),
	('Викторович',1),
	('Витальевич',1),
	('Владимирович',1),
	('Владимировна',1),
	('Владиславович',1),
	('Власиевич',1),
	('Всеволодович',1),
	('Вячеславович',1),
	('Геннадьевич',1),
	('Георгиевич',1),
	('Григорьевич',1),
	('Данилович',1),
	('Даянович',1),
	('Денисович',1),
	('Дмитриевич',1),
	('Евгеньевич',1),
	('Егорович',1),
	('Емельянович',1),
	('Захарович',1),
	('Иванович',1),
	('Игоревич',1),
	('Ильич',1),
	('Касьянович',1),
	('Кириллович',1),
	('Константинович',1),
	('Ксенофонтович',1),
	('Кузьмич',1),
	('Леонидович',1),
	('Леопольдович',1),
	('Львович',1),
	('Макарович',1),
	('Максимович',1),
	('Михайлович',1),
	('Мусеевна',1),
	('Никитич',1),
	('Никифорович',1),
	('Николаевич',1),
	('Олегович',1),
	('Павлович',1),
	('Петрович',1),
	('Платонович',1),
	('Романович',1),
	('Русланович',1),
	('Сергеевич',1),
	('Станиславович',1),
	('Степанович',1),
	('Тимофеевич',1),
	('Тимурович',1),
	('Трофимович',1),
	('Фанисович',1),
	('Фёдорович',1),
	('Федотович',1),
	('Фомич',1),
	('Эдуардович',1),
	('Юрьевич',1),
	('Яковлевич',1),
	('Александрович',2),
	('Александровна',2),
	('Алексеевна',2),
	('Альбертовна',2),
	('Анатольевна',2),
	('Андреевна',2),
	('Антоновна',2),
	('Аркадьевна',2),
	('Афанасьевна',2),
	('Богдановна',2),
	('Борисовна',2),
	('Вадимовна',2),
	('Валентиновна',2),
	('Валерьевна',2),
	('Васильевна',2),
	('Викторовна',2),
	('Витальевна',2),
	('Владимировна',2),
	('Владиславовна',2),
	('Власиевна',2),
	('Всеволодовна',2),
	('Вячеславовна',2),
	('Геннадьевна',2),
	('Георгиевна',2),
	('Григорьевна',2),
	('Даниловна',2),
	('Денисовна',2),
	('Дмитриевна',2),
	('Евгеньевна',2),
	('Егоровна',2),
	('Емельяновна',2),
	('Захаровна',2),
	('Ивановна',2),
	('Игоревна',2),
	('Ильинична',2),
	('Касьяновна',2),
	('Кирилловна',2),
	('Константиновна',2),
	('Ксенофонтовна',2),
	('Кузьминична',2),
	('Леонидовна',2),
	('Леопольдовна',2),
	('Львовна',2),
	('Макаровна',2),
	('Максимовна',2),
	('Маратовна',2),
	('Михайловна',2),
	('Никитична',2),
	('Никифоровна',2),
	('Николаевна',2),
	('Олеговна',2),
	('Павловна',2),
	('Петровна',2),
	('Платоновна',2),
	('Рамилевна',2),
	('Романовна',2),
	('Руслановна',2),
	('Саматовна',2),
	('Сергеевна',2),
	('Станиславовна',2),
	('Степановна',2),
	('Султангалиевна',2),
	('Суреновна',2),
	('Тимофеевна',2),
	('Тимуровна',2),
	('Трифоновна',2),
	('Трофимовна',2),
	('Фёдоровна',2),
	('Федотовна',2),
	('Фоминична',2),
	('Эдуардовна',2),
	('Юрьевна',2),
	('Явдатовна',2),
	('Яковлевна',2);
 declare @names_m_2 nvarchar(max) = (SELECT  STRING_AGG(Cast(middlename as nvarchar(max)),',') AS Result FROM @names_m where gender = @gender)
 RETURN  @names_m_2
end




--select * from STRING_SPLIT(dbo.RandomLastname(2),',')

